aW1wb3J0IHN5cw0KaW1wb3J0IGpzb24NCg0KZGVmIHJ1bl90ZXN0KHRlc3RfaW5wdXQsIGV4cGVj
dGVkX291dHB1dCwgZnVuY3Rpb25fbmFtZSk6DQogICAgdHJ5Og0KICAgICAgICAjIEV4ZWN1dGUg
dGhlIHNvbHV0aW9uIGNvZGUgaW4gdGhlIGdsb2JhbCBzY29wZQ0KICAgICAgICBnbG9iYWxzX2Rp
Y3QgPSB7fQ0KICAgICAgICBleGVjKHNvbHV0aW9uX2NvZGUsIGdsb2JhbHNfZGljdCkNCiAgICAg
ICAgaWYgZnVuY3Rpb25fbmFtZSBub3QgaW4gZ2xvYmFsc19kaWN0IG9yIG5vdCBjYWxsYWJsZShn
bG9iYWxzX2RpY3RbZnVuY3Rpb25fbmFtZV0pOg0KICAgICAgICAgICAgcmV0dXJuIHsidGVzdF9j
YXNlIjogdGVzdF9pbnB1dCwgImVycm9yIjogIkVycm9yOiBUaGUgZnVuY3Rpb24ge30gaXMgbm90
IGRlZmluZWQuIi5mb3JtYXQoZnVuY3Rpb25fbmFtZSksICJyZXN1bHQiOiAiRmFpbGVkIn0NCg0K
ICAgICAgICAjIFRlc3QgdGhlIGZ1bmN0aW9uIHdpdGggdGhlIHByb3ZpZGVkIGlucHV0DQogICAg
ICAgIHJlc3VsdCA9IGdsb2JhbHNfZGljdFtmdW5jdGlvbl9uYW1lXSh0ZXN0X2lucHV0KQ0KDQog
ICAgICAgICMgQ2hlY2sgaWYgdGhlIHJlc3VsdCBtYXRjaGVzIHRoZSBleHBlY3RlZCBvdXRwdXQN
CiAgICAgICAgaWYgcmVzdWx0ICE9IGV4cGVjdGVkX291dHB1dDoNCiAgICAgICAgICAgIHJldHVy
biB7InRlc3RfY2FzZSI6IHRlc3RfaW5wdXQsICJlcnJvciI6IE5vbmUsICJyZXN1bHQiOiAiRmFp
bGVkIiwgImRldGFpbHMiOiB7ImV4cGVjdGVkX291dHB1dCI6IGV4cGVjdGVkX291dHB1dCwgImFj
dHVhbF9vdXRwdXQiOiByZXN1bHR9fQ0KDQogICAgICAgICMgSWYgdGhlIHJlc3VsdCBtYXRjaGVz
IHRoZSBleHBlY3RlZCBvdXRwdXQsIHJldHVybiBzdWNjZXNzDQogICAgICAgIHJldHVybiB7InRl
c3RfY2FzZSI6IHRlc3RfaW5wdXQsICJlcnJvciI6IE5vbmUsICJyZXN1bHQiOiAiUGFzc2VkIn0N
Cg0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgcmV0dXJuIHsidGVzdF9jYXNl
IjogdGVzdF9pbnB1dCwgImVycm9yIjogIkVycm9yOiB7fSIuZm9ybWF0KHN0cihlKSksICJyZXN1
bHQiOiAiRmFpbGVkIn0NCg0KZGVmIGNoZWNrX2ZpYm9uYWNjaV9zb2x1dGlvbihzb2x1dGlvbl9m
aWxlX3BhdGgsIHRlc3RfY2FzZXMpOg0KICAgIHRyeToNCiAgICAgICAgd2l0aCBvcGVuKHNvbHV0
aW9uX2ZpbGVfcGF0aCwgJ3InKSBhcyBmaWxlOg0KICAgICAgICAgICAgZ2xvYmFsIHNvbHV0aW9u
X2NvZGUNCiAgICAgICAgICAgIHNvbHV0aW9uX2NvZGUgPSBmaWxlLnJlYWQoKQ0KDQogICAgICAg
IHJlc3VsdHMgPSBbXQ0KICAgICAgICBmb3IgdGVzdF9jYXNlIGluIHRlc3RfY2FzZXM6DQogICAg
ICAgICAgICByZXN1bHQgPSBydW5fdGVzdCh0ZXN0X2Nhc2VbImlucHV0Il0sIHRlc3RfY2FzZVsi
b3V0cHV0Il0sIHRlc3RfY2FzZVsiZnVuY3Rpb25fbmFtZSJdKQ0KICAgICAgICAgICAgcmVzdWx0
cy5hcHBlbmQocmVzdWx0KQ0KDQogICAgICAgIHJldHVybiBqc29uLmR1bXBzKHJlc3VsdHMsIGlu
ZGVudD0yKQ0KDQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICByZXR1cm4ganNv
bi5kdW1wcyhbeyJlcnJvciI6ICJFcnJvcjoge30iLmZvcm1hdChzdHIoZSkpfV0sIGluZGVudD0y
KQ0KDQppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOg0KICAgIGlmIGxlbihzeXMuYXJndikgIT0g
MjoNCiAgICAgICAgcHJpbnQoIlVzYWdlOiBweXRob24gY2hlY2tfc29sdXRpb24ucHkgPHNvbHV0
aW9uX2ZpbGVfcGF0aD4iKQ0KICAgICAgICBzeXMuZXhpdCgxKQ0KDQogICAgIyBEZWZpbmUgMTAg
dGVzdCBjYXNlcyB3aXRoIGlucHV0LCBleHBlY3RlZCBvdXRwdXQsIGFuZCBmdW5jdGlvbiBuYW1l
DQogICAgdGVzdF9jYXNlcyA9IFsNCiAgICAgICAgeyJpbnB1dCI6IDAsICJvdXRwdXQiOiBbXSwg
ImZ1bmN0aW9uX25hbWUiOiAiZ2VuZXJhdGVfZmlib25hY2NpIn0sDQogICAgICAgIHsiaW5wdXQi
OiAxLCAib3V0cHV0IjogWzBdLCAiZnVuY3Rpb25fbmFtZSI6ICJnZW5lcmF0ZV9maWJvbmFjY2ki
fSwNCiAgICAgICAgeyJpbnB1dCI6IDIsICJvdXRwdXQiOiBbMCwgMV0sICJmdW5jdGlvbl9uYW1l
IjogImdlbmVyYXRlX2ZpYm9uYWNjaSJ9LA0KICAgICAgICB7ImlucHV0IjogNSwgIm91dHB1dCI6
IFswLCAxLCAxLCAyLCAzXSwgImZ1bmN0aW9uX25hbWUiOiAiZ2VuZXJhdGVfZmlib25hY2NpIn0s
DQogICAgICAgIHsiaW5wdXQiOiAxMCwgIm91dHB1dCI6IFswLCAxLCAxLCAyLCAzLCA1LCA4LCAx
MywgMjEsIDM0XSwgImZ1bmN0aW9uX25hbWUiOiAiZ2VuZXJhdGVfZmlib25hY2NpIn0sDQogICAg
ICAgIHsiaW5wdXQiOiAxNSwgIm91dHB1dCI6IFswLCAxLCAxLCAyLCAzLCA1LCA4LCAxMywgMjEs
IDM0LCA1NSwgODksIDE0NCwgMjMzLCAzNzddLCAiZnVuY3Rpb25fbmFtZSI6ICJnZW5lcmF0ZV9m
aWJvbmFjY2kifSwNCiAgICAgICAgeyJpbnB1dCI6IDIwLCAib3V0cHV0IjogWzAsIDEsIDEsIDIs
IDMsIDUsIDgsIDEzLCAyMSwgMzQsIDU1LCA4OSwgMTQ0LCAyMzMsIDM3NywgNjEwLCA5ODcsIDE1
OTcsIDI1ODQsIDQxODFdLCAiZnVuY3Rpb25fbmFtZSI6ICJnZW5lcmF0ZV9maWJvbmFjY2kifSwN
CiAgICAgICAgeyJpbnB1dCI6IDI1LCAib3V0cHV0IjogWzAsIDEsIDEsIDIsIDMsIDUsIDgsIDEz
LCAyMSwgMzQsIDU1LCA4OSwgMTQ0LCAyMzMsIDM3NywgNjEwLCA5ODcsIDE1OTcsIDI1ODQsIDQx
ODEsIDY3NjUsIDEwOTQ2LCAxNzcxMSwgMjg2NTcsIDQ2MzY4XSwgImZ1bmN0aW9uX25hbWUiOiAi
Z2VuZXJhdGVfZmlib25hY2NpIn0sDQogICAgICAgIHsiaW5wdXQiOiAzMCwgIm91dHB1dCI6IFsw
LCAxLCAxLCAyLCAzLCA1LCA4LCAxMywgMjEsIDM0LCA1NSwgODksIDE0NCwgMjMzLCAzNzcsIDYx
MCwgOTg3LCAxNTk3LCAyNTg0LCA0MTgxLCA2NzY1LCAxMDk0NiwgMTc3MTEsIDI4NjU3LCA0NjM2
OCwgNzUwMjUsIDEyMTM5MywgMTk2NDE4LCAzMTc4MTEsIDUxNDIyOV0sICJmdW5jdGlvbl9uYW1l
IjogImdlbmVyYXRlX2ZpYm9uYWNjaSJ9LA0KICAgIF0NCg0KICAgIHNvbHV0aW9uX2ZpbGVfcGF0
aCA9IHN5cy5hcmd2WzFdDQogICAgcmVzdWx0ID0gY2hlY2tfZmlib25hY2NpX3NvbHV0aW9uKHNv
bHV0aW9uX2ZpbGVfcGF0aCwgdGVzdF9jYXNlcykNCiAgICBwcmludChyZXN1bHQpDQo=
